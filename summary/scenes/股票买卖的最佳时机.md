# è‚¡ç¥¨ä¹°å–çš„æœ€ä½³æ—¶æœº

## æ¨å¯¼
æ¨å¯¼æ€è·¯ï¼šç©·ä¸¾
```js
åˆ©ç”¨ [çŠ¶æ€] è¿›è¡Œç©·ä¸¾ï¼Œå°†æ‰€æœ‰çš„å¯èƒ½æ€§åˆ—ä¸¾å‡º
for çŠ¶æ€1 in çŠ¶æ€1çš„æ‰€æœ‰å–å€¼ï¼š
    for çŠ¶æ€2 in çŠ¶æ€2çš„æ‰€æœ‰å–å€¼ï¼š
        for ...
            dp[çŠ¶æ€1][çŠ¶æ€2][...] = æ‹©ä¼˜(é€‰æ‹©1ï¼Œé€‰æ‹©2...)

```

### çŠ¶æ€

è‚¡ç¥¨é—®é¢˜çŠ¶æ€æœ‰3ç§
- å¤©æ•°ï¼šç¬¬iå¤©

- å½“å¤©æ“ä½œåå…è®¸äº¤æ˜“çš„æœ€å¤§æ¬¡æ•°ï¼š

  å…¶å®å¯¹äºæœ€å¤§å¯äº¤æ˜“æ¬¡æ•°ï¼Œå¤§éƒ¨åˆ†åœºæ™¯éƒ½æ˜¯é™åˆ¶äº†1æ¬¡äº¤æ˜“ || ä¸é™åˆ¶äº¤æ˜“æ¬¡æ•°

- å½“å¤©çš„æŒæœ‰çŠ¶æ€ï¼šæŒæœ‰è‚¡ç¥¨1ã€æœªæŒæœ‰è‚¡ç¥¨0

```js
dp[i][j][0 or 1]
0 <= i <= n-1, 1 <= j <= K
    tips: jæ˜¯ä»1...Kå¼€å§‹éå†çš„ï¼Œå› ä¸ºå…è®¸äº¤æ˜“çš„æœ€å¤§æ¬¡æ•°æ˜¯é€’å‡çš„ï¼Œéœ€è¦é¢„ç•™ä¸€ä½ä»¥å…é”™è¯¯
n ä¸ºå¤©æ•°ï¼Œå¤§ K ä¸ºæœ€å¤šäº¤æ˜“æ•°
æ­¤é—®é¢˜å…± n Ã— K Ã— 2 ç§çŠ¶æ€ï¼Œå…¨éƒ¨ç©·ä¸¾å°±èƒ½æå®šã€‚

for 0 <= i < n:
    for 1 <= j <= K:
        for s in {0, 1}:
            dp[i][j][s] = max(buy, sell, rest)

ä¾‹å¦‚ï¼š
dp[3][2][1]: ä»Šå¤©æ˜¯ç¬¬3å¤©ï¼Œæˆ‘æ‰‹ä¸ŠæŒæœ‰è‚¡ç¥¨ï¼Œè¿˜å¯è‡³å¤šäº¤æ˜“2æ¬¡ï¼Œè‡³æ­¤æˆ‘è·å¾—çš„æ”¶ç›Š
dp[3][2][0]: ä»Šå¤©æ˜¯ç¬¬3å¤©ï¼Œæˆ‘æ‰‹ä¸Šæ²¡æœ‰æŒæœ‰è‚¡ç¥¨ï¼Œè¿˜å¯è‡³å¤šäº¤æ˜“2æ¬¡ï¼Œè‡³æ­¤æˆ‘è·å¾—çš„æ”¶ç›Š
æ”¶ç›Šè¯´æ˜ï¼šå½“å¤©è‚¡ç¥¨ä»·æ ¼prices[i]ï¼šğŸ’°
å‰ä¸€å¤©æœªæŒæœ‰ <-> ä»Šå¤©æŒæœ‰ï¼šè¯´æ˜æˆ‘ä¹°å…¥äº†è‚¡ç¥¨ï¼Œé‚£ä¹ˆæˆ‘å°†ä»˜å‡ºå½“å¤©è‚¡ç¥¨ä»·æ ¼çš„ğŸ’°ï¼Œæ”¶ç›Š - ğŸ’°
å‰ä¸€å¤©æŒæœ‰ <-> ä»Šå¤©æœªæŒæœ‰ï¼šè¯´æ˜æˆ‘å–äº†è‚¡ç¥¨äº†ï¼Œé‚£ä¹ˆæˆ‘å°†è·å¾—å½“å¤©è‚¡ç¥¨ä»·æ ¼çš„ğŸ’°ï¼Œæ”¶ç›Š + ğŸ’°
		**çœŸå®æ”¶ç›Šå…¶å®å°±æ˜¯ ä¹°å–è‚¡ç¥¨æ—¶ä»·æ ¼çš„å·®å€¼**
å‰ä¸€å¤©æŒæœ‰ <-> ä»Šå¤©æŒæœ‰ï¼šè¯´æ˜æˆ‘æ²¡æœ‰æ“ä½œï¼Œé‚£ä¹ˆæˆ‘çš„æ”¶ç›Šå°†ä¸ä¼šæ”¹å˜
å‰ä¸€å¤©æœªæŒæœ‰ <-> ä»Šå¤©æœªæŒæœ‰ï¼šè¯´æ˜æˆ‘æ²¡æœ‰æ“ä½œï¼Œé‚£ä¹ˆæˆ‘çš„æ”¶ç›Šå°†ä¸ä¼šæ”¹å˜
```

### çŠ¶æ€è½¬ç§»æ–¹ç¨‹

![](https://tva1.sinaimg.cn/large/007S8ZIlgy1ghravyqc89j30m20efaa6.jpg)

```js
dp[i][j][0] = max(dp[i-1][j][0], dp[i-1][j][1] + prices[i])
			  max(å‰ä¸€å¤©æœªæŒæœ‰è‚¡ç¥¨, å‰ä¸€å¤©æŒæœ‰è‚¡ç¥¨)
              max(é€‰æ‹© rest, é€‰æ‹© sell)

dp[i][j][1] = max(dp[i-1][j][1], dp[i-1][j-1][0] - prices[i])
			  max(å‰ä¸€å¤©æŒæœ‰è‚¡ç¥¨, å‰ä¸€å¤©æœªæŒæœ‰è‚¡ç¥¨)
              max(é€‰æ‹© rest, é€‰æ‹© buy)
```

### base caseåˆå§‹åŒ–

```js
dp[0][j][0] = 0 å› ä¸ºæˆ‘æ²¡æœ‰ä¹°å…¥è‚¡ç¥¨
    tips: è¿™é‡Œä»£è¡¨ dp[0][1][0]ã€dp[0][2][0].....dp[0][K][0] = 0
dp[0][j-1][1] = -prices[0] ç¬¬ä¸€å¤©ä¹°å…¥äº†è‚¡ç¥¨
    tips: è¿™é‡Œä»£è¡¨ dp[0][1][1]ã€dp[0][2][1].....dp[0][K][1] = -prices[0]

dp[i][0][0] = max(dp[i - 1][0][0], dp[i - 1][-1][1] + prices[i]) = 0
```

### æœ€ä¼˜è§£è¾“å‡º

```js
dp[i][K][0] å³æœ€åä¸€å¤©æ—¶ï¼Œæˆ‘æ‰‹ä¸Šæ²¡æœ‰æŒæœ‰è‚¡ç¥¨æ‰€å¾—çš„æœ€å¤§æ”¶ç›Š(ç›¸è¾ƒäºæŒæœ‰ï¼ŒæœªæŒæœ‰çš„æ”¶ç›Šè‚¯å®šæœ€å¤§
```

## ä¼˜åŒ–
### å½“ K æ— é™åˆ¶æ—¶ï¼Œä¸”æ²¡æœ‰å…¶ä»–é™åˆ¶
å¯ä»¥å°†ç®—æ³•ä» åŠ¨æ€è§„åˆ’ç®—æ³• å‘ è´ªå¿ƒç®—æ³• æ¼”å˜

- æ— é™åˆ¶çš„å«ä¹‰
```js
1. é™¤å»é¢˜ç›®ä¸­æ˜ç¡®åˆ¶å®šäº†æ— é™åˆ¶
2. ç”±äºä¸€æ¬¡äº¤æ˜“è‡³å°‘éœ€è¦ä¸¤å¤©çš„æ—¶é—´ï¼Œä¸€å¤©ä¹°å…¥ï¼Œä¸€å¤©å–å‡º
é‚£ä¹ˆåªè¦æ»¡è¶³ K > prices.length / 2 åŒæ ·å¯ä»¥è®¤ä¸ºæ˜¯æ— é™åˆ¶
```
- è´ªå¿ƒç®—æ³•
```js
å¦‚æœç¬¬äºŒå¤©ç›¸è¾ƒç¬¬ä¸€å¤©ï¼Œ
    å­˜åœ¨åˆ©æ¶¦ï¼Œé‚£ä¹ˆæˆ‘å°†ä¼šåœ¨ç¬¬ä¸€å¤©ä¹°å…¥è‚¡ç¥¨
    ä¸å­˜åœ¨æ¶¦ï¼Œé‚£ä¹ˆæˆ‘å°†ä¸ä¼šä¹°å…¥
å¦‚æœç¬¬äºŒå¤©ç›¸è¾ƒç¬¬ä¸‰å¤©ï¼Œ
    å­˜åœ¨åˆ©æ¶¦ï¼Œé‚£ä¹ˆæˆ‘å°†ä¼š [ç»§ç»­æŒæœ‰è‚¡ç¥¨] æˆ–è€… [ä¹°å…¥è‚¡ç¥¨]
    ä¸å­˜åœ¨æ¶¦ï¼Œé‚£ä¹ˆæˆ‘å°†ä¼š [å–å‡ºè‚¡ç¥¨] æˆ–è€… [ä¸ä¹°å…¥è‚¡ç¥¨]
ç»¼ä¸Šæ‰€è¿°ï¼Œå…¶ä»–æ•´ä½“çš„åˆ©æ¶¦å°±æ˜¯è‚¡ç¥¨ [ä»·æ ¼å˜åŠ¨çš„ä¸Šå‡åŒºé—´]
```

### å½“ K æ— é™åˆ¶æˆ–è€…é™åˆ¶åªèƒ½äº¤æ˜“1æ¬¡ï¼Œä¸”å­˜åœ¨å…¶ä»–é™åˆ¶æ—¶
å­˜åœ¨æŸäº›é™åˆ¶ï¼Œå¯¼è‡´ç®—æ³•æ— æ³•é€šè¿‡è´ªå¿ƒå¾—å‡º

å¯ä»¥é€šè¿‡å¢åŠ å‚æ•°ï¼Œå°†å¤šç»´æ•°ç»„æ‰å¹³åŒ–

å¯ä»¥ä»çŠ¶æ€è½¬ç§»æ–¹ç¨‹çœ‹å‡ºï¼Œæ•´ä¸ªæµç¨‹å…¶å®åªéœ€è¦å‡ ä¸ªå˜é‡å³å¯
```js
dp[i][j][0]
dp[i][j][1]
dp[i - 1][j][0]
dp[i - 1][j][1]
dp[i - 1][j - 1][0]

å¯ä»¥å°† dp[i] å±‚çº§æå–å‡ºï¼Œç®€åŒ–å±‚çº§
dp[i][j][0] => now[j][0] => nowUnHold[j]
dp[i][j][1] => now[j][1] => nowHold[j]
dp[i - 1][j][0] => pre[j][0] => preUnHold[j]
dp[i - 1][j][1] => pre[j][0] => preHold[j]
dp[i - 1][j-1][0] => pre[j-1][0] => preUnHold[j-1]

åœ¨æŸäº›å ´æ™¯ä¸‹ï¼ŒKå€¼ä¸º1ï¼Œå¯ä»¥è¿›ä¸€æ­¥å°†Kå€¼ä¼˜åŒ–
dp[i][j][0] => nowUnHold
dp[i][j][1] => nowHold
dp[i - 1][j][0] => preUnHold
dp[i - 1][j][1] => preHold
dp[i - 1][j-1][0] => preUnHold
```

## ç›¸å…³é¢˜ç›®
- [121.best-time-to-buy-adn-sell-stock](https://github.com/XyyF/elfin-algorithm/blob/master/problems/121.best-time-to-buy-and-sell-stock.md)
- [122.best-time-to-buy-adn-sell-stock-ii](https://github.com/XyyF/elfin-algorithm/blob/master/problems/122.best-time-to-buy-and-sell-stock-ii.md)
- [123.best-time-to-buy-adn-sell-stock-iii](https://github.com/XyyF/elfin-algorithm/blob/master/problems/123.best-time-to-buy-and-sell-stock-iii.md)
- [309.best-time-to-buy-adn-sell-stock-with-cooldown](https://github.com/XyyF/elfin-algorithm/blob/master/problems/309.best-time-to-buy-and-sell-stock-with-cooldown.md)
- [714.best-time-to-buy-adn-sell-stock-with-transaction-fee](https://github.com/XyyF/elfin-algorithm/blob/master/problems/714.best-time-to-buy-and-sell-stock-with-transaction-fee.md)